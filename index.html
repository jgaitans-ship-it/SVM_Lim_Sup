<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Julio César Gaitán Silva">

<title>SVM_Lim_Sup</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="SVM_Lim_Sup_files/libs/clipboard/clipboard.min.js"></script>
<script src="SVM_Lim_Sup_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="SVM_Lim_Sup_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="SVM_Lim_Sup_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="SVM_Lim_Sup_files/libs/quarto-html/popper.min.js"></script>
<script src="SVM_Lim_Sup_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="SVM_Lim_Sup_files/libs/quarto-html/anchor.min.js"></script>
<link href="SVM_Lim_Sup_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="SVM_Lim_Sup_files/libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="SVM_Lim_Sup_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="SVM_Lim_Sup_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="SVM_Lim_Sup_files/libs/bootstrap/bootstrap-9e3ffae467580fdb927a41352e75a2e0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">SVM_Lim_Sup</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Julio César Gaitán Silva </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="cargar-librerías" class="level1">
<h1>1. Cargar librerías</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>terra 1.8.80</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)       <span class="co"># Para trabajar con datos raster</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: sp</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)           <span class="co"># Para manipulación de datos espaciales</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.13.1, GDAL 3.11.4, PROJ 9.7.0; sf_use_s2() is TRUE</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)     <span class="co"># Para manejar archivos Excel</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)    <span class="co"># Conjunto de paquetes para manipulación de datos\library(DataExplorer) # Exploración de datos</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.6
✔ forcats   1.0.1     ✔ stringr   1.6.0
✔ ggplot2   4.0.1     ✔ tibble    3.3.0
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.2.0     </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ tidyr::extract() masks raster::extract(), terra::extract()
✖ dplyr::filter()  masks stats::filter()
✖ dplyr::lag()     masks stats::lag()
✖ dplyr::select()  masks raster::select()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tmap)        <span class="co"># Visualización de mapas\library(ithir)       # Modelado de suelos</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(aqp)         <span class="co"># Análisis de perfiles de suelo</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is aqp 2.2-1

Adjuntando el paquete: 'aqp'

The following objects are masked from 'package:dplyr':

    combine, slice

The following objects are masked from 'package:raster':

    coordinates, metadata, metadata&lt;-, proj4string

The following objects are masked from 'package:sp':

    coordinates, coordinates&lt;-, proj4string, proj4string&lt;-</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="carpeta-donde-están-todos-los-rásters-ya-procesados" class="level1">
<h1>2. Carpeta donde están TODOS los rásters ya procesados</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>ruta <span class="ot">&lt;-</span> <span class="st">"D:/Meta_vichada/aligned/"</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>rasters_sel <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Aspect.tif",</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"C.O.tif"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"CI.tif"</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Convergence_Index.tif",</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Hillshade.tif",</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"HH.tif",</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"HV.tif"</span>,</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"LS_Factor.tif"</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"MCARI.tif"</span>,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"NDTI.tif"</span>,</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Plan_Curvature.tif",</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Precipitación.tif",</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Profile_Curvature.tif",</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Relative_Slope_Position.tif"</span>,</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Suelos_.tif"</span>,</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Temperatura_Media_.tif",</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Topographic_Wetness_Index.tif"</span>,</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Total_Catchment_Area.tif",</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Valley_Depth.tif"</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"GNDVI.tif",</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"BSI.tif",</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Channel_Network_Base_Level.tif",</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Channel_Network_Distance.tif",</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"DEM.tif",</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"EVI.tif",</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"NBR.tif",</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"NDVI.tif",</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"NDWI.tif",</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"SAVI.tif",</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Slope.tif"</span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Temperatura_Maxima_.tif",</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>  <span class="co">#"Temperatura_Minima_.tif",</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="construir-rutas-completas-solo-de-los-seleccionados" class="level1">
<h1>3. Construir rutas completas SOLO de los seleccionados</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>files_sel <span class="ot">&lt;-</span> <span class="fu">file.path</span>(ruta, rasters_sel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="verificar-cuáles-existen-control-de-errores" class="level1">
<h1>4. Verificar cuáles existen (control de errores)</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>files_sel <span class="ot">&lt;-</span> files_sel[<span class="fu">file.exists</span>(files_sel)]</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Si alguno falta, aquí lo ves</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">basename</span>(files_sel))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "C.O.tif"                       "CI.tif"                       
 [3] "HV.tif"                        "LS_Factor.tif"                
 [5] "MCARI.tif"                     "NDTI.tif"                     
 [7] "Relative_Slope_Position.tif"   "Suelos_.tif"                  
 [9] "Topographic_Wetness_Index.tif" "Valley_Depth.tif"             </code></pre>
</div>
</div>
</section>
<section id="cargar-como-spatraster" class="level1">
<h1>5. Cargar como SpatRaster</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>raster <span class="ot">&lt;-</span> <span class="fu">rast</span>(files_sel)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="verificación-rápida" class="level1">
<h1>6. Verificación rápida</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">compareGeom</span>(raster, raster[[<span class="dv">1</span>]], <span class="at">stopOnError =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="visualización" class="level1">
<h1>7. Visualización</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(raster)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SVM_Lim_Sup_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="obtener-coordenadas-únicas" class="level1">
<h1>8. Obtener coordenadas únicas</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>SCHS <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"D:/MAESTRIA/Trabajo_final/SCHS.xlsx"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>Coor <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Perfil_COD1=</span>SCHS<span class="sc">$</span>Perfil_COD1,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Latitud =</span> SCHS<span class="sc">$</span>Latitud,</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Longitud =</span> SCHS<span class="sc">$</span>Longitud,</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Lim_sup =</span> SCHS<span class="sc">$</span>lim_sup)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Lim_inf = SCHS$lim_inf )</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(Coor)</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Coor)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   225 obs. of  4 variables:
 $ Perfil_COD1: chr  "AR-011" "AR-021" "AR-026" "AR-043" ...
 $ Latitud    : num  3.36 3.5 3.46 3.38 4.5 ...
 $ Longitud   : num  -73.7 -74 -73.9 -73.7 -71.3 ...
 $ Lim_sup    : num  13.8 13.5 11.7 16.8 27.6 ...</code></pre>
</div>
</div>
</section>
<section id="convertir-a-formato-espacial-sf" class="level1">
<h1>9. Convertir a formato espacial (sf)</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>data_final_sf <span class="ot">&lt;-</span> <span class="fu">st_as_sf</span>(<span class="at">x =</span> Coor,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">coords =</span> <span class="fu">c</span>(<span class="st">"Longitud"</span>, <span class="st">"Latitud"</span>),</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">crs =</span> <span class="fu">st_crs</span>(<span class="dv">4326</span>))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span>(data_final_sf)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="visualizar-los-puntos-sobre-el-modelo-de-elevación-dem" class="level1">
<h1>10. Visualizar los puntos sobre el modelo de elevación (DEM)</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(raster<span class="sc">$</span>Topographic_Wetness_Index)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">st_geometry</span>(data_final_sf), <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col=</span> <span class="st">"red"</span>, <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SVM_Lim_Sup_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="visualización-con-tmap" class="level1">
<h1>11. Visualización con tmap</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(raster<span class="sc">$</span>Topographic_Wetness_Index) <span class="sc">+</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_raster</span>(<span class="at">palette =</span> <span class="fu">c</span>(<span class="st">"#CCCCCC"</span>, <span class="st">"#999999"</span>, <span class="st">"#666666"</span>, <span class="st">"#333333"</span>, <span class="st">"#000000"</span>)) <span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(data_final_sf) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_dots</span>(<span class="st">"Lim_sup"</span>, <span class="at">palette =</span> <span class="st">"-RdYlBu"</span>, <span class="at">size =</span> <span class="fl">0.25</span>) <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_layout</span>(<span class="st">"Mapa Lim_Sup cm"</span>) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_compass</span>() <span class="sc">+</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_scale_bar</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code></code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── tmap v3 code detected ───────────────────────────────────────────────────────</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>[v3-&gt;v4] `tm_tm_raster()`: migrate the argument(s) related to the scale of the
visual variable `col` namely 'palette' (rename to 'values') to col.scale =
tm_scale(&lt;HERE&gt;).
[v3-&gt;v4] `tm_tm_dots()`: migrate the argument(s) related to the scale of the
visual variable `fill` namely 'palette' (rename to 'values') to fill.scale =
tm_scale(&lt;HERE&gt;).
[v3-&gt;v4] `tm_layout()`: use `tm_title()` instead of `tm_layout(title = )`
! `tm_scale_bar()` is deprecated. Please use `tm_scalebar()` instead.
SpatRaster object downsampled to 2505 by 3993 cells.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SVM_Lim_Sup_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="extraer-valores-raster-en-los-puntos-espaciales" class="level1">
<h1>12. Extraer valores raster en los puntos espaciales</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>extraccion <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">extract</span>(raster, <span class="fu">vect</span>(data_final_sf))</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>data_sf <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data_final_sf, extraccion[, <span class="sc">-</span><span class="dv">1</span>])</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">view</span> (data_sf)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="modelamiento--" class="level1">
<h1>13. Modelamiento —————————————————————-</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)        <span class="co"># Para ajuste de modelos</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Cargando paquete requerido: lattice</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Adjuntando el paquete: 'caret'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:purrr':

    lift</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(randomForest) <span class="co"># Random Forest</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>randomForest 4.7-1.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type rfNews() to see new features/changes/bug fixes.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Adjuntando el paquete: 'randomForest'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:aqp':

    combine</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    margin</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ranger)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Adjuntando el paquete: 'ranger'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:randomForest':

    importance</code></pre>
</div>
</div>
</section>
<section id="resumen-de-los-datos-espaciales" class="level1">
<h1>14. Resumen de los datos espaciales</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_sf)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> Perfil_COD1           Lim_sup             C.O              CI        
 Length:225         Min.   :  3.625   Min.   :16.10   Min.   :0.1548  
 Class :character   1st Qu.: 11.374   1st Qu.:22.62   1st Qu.:0.5939  
 Mode  :character   Median : 14.841   Median :25.25   Median :0.7866  
                    Mean   : 19.103   Mean   :26.68   Mean   :0.9230  
                    3rd Qu.: 22.794   3rd Qu.:31.79   3rd Qu.:1.1672  
                    Max.   :115.774   Max.   :70.25   Max.   :2.3920  
       HV            LS_Factor             MCARI               NDTI        
 Min.   :-31.215   Min.   : 0.000109   Min.   :0.008303   Min.   :0.02205  
 1st Qu.:-23.700   1st Qu.: 0.187458   1st Qu.:0.048938   1st Qu.:0.16568  
 Median :-19.620   Median : 0.400085   Median :0.062091   Median :0.18370  
 Mean   :-19.575   Mean   : 1.368948   Mean   :0.063347   Mean   :0.17972  
 3rd Qu.:-15.374   3rd Qu.: 1.022462   3rd Qu.:0.077835   3rd Qu.:0.20163  
 Max.   : -8.273   Max.   :42.507114   Max.   :0.133466   Max.   :0.23763  
 Relative_Slope_Position    Suelos_      Topographic_Wetness_Index
 Min.   :0.000000        Min.   : 0.00   Min.   : 5.026           
 1st Qu.:0.001673        1st Qu.: 4.00   1st Qu.: 7.364           
 Median :0.008315        Median :17.00   Median : 8.340           
 Mean   :0.037083        Mean   :23.09   Mean   : 9.751           
 3rd Qu.:0.033621        3rd Qu.:40.00   3rd Qu.:10.840           
 Max.   :0.781887        Max.   :57.00   Max.   :25.343           
  Valley_Depth              geometry  
 Min.   :  4.941   POINT        :225  
 1st Qu.:121.764   epsg:4326    :  0  
 Median :195.087   +proj=long...:  0  
 Mean   :237.062                      
 3rd Qu.:304.421                      
 Max.   :770.234                      </code></pre>
</div>
</div>
</section>
<section id="convertir-a-dataframe-para-modelado-no-se-tiene-en-cuenta-la-columna-id" class="level1">
<h1>15. Convertir a dataframe para modelado, no se tiene en cuenta la columna ID</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>data_sf_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(data_sf)[<span class="dv">2</span><span class="sc">:</span><span class="dv">12</span>]</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>data_sf_df <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(data_sf_df)<span class="co">#</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_sf_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Lim_sup             C.O              CI               HV         
 Min.   :  3.625   Min.   :16.10   Min.   :0.1548   Min.   :-31.215  
 1st Qu.: 11.374   1st Qu.:22.62   1st Qu.:0.5939   1st Qu.:-23.700  
 Median : 14.841   Median :25.25   Median :0.7866   Median :-19.620  
 Mean   : 19.103   Mean   :26.68   Mean   :0.9230   Mean   :-19.575  
 3rd Qu.: 22.794   3rd Qu.:31.79   3rd Qu.:1.1672   3rd Qu.:-15.374  
 Max.   :115.774   Max.   :70.25   Max.   :2.3920   Max.   : -8.273  
   LS_Factor             MCARI               NDTI        
 Min.   : 0.000109   Min.   :0.008303   Min.   :0.02205  
 1st Qu.: 0.187458   1st Qu.:0.048938   1st Qu.:0.16568  
 Median : 0.400085   Median :0.062091   Median :0.18370  
 Mean   : 1.368948   Mean   :0.063347   Mean   :0.17972  
 3rd Qu.: 1.022462   3rd Qu.:0.077835   3rd Qu.:0.20163  
 Max.   :42.507114   Max.   :0.133466   Max.   :0.23763  
 Relative_Slope_Position    Suelos_      Topographic_Wetness_Index
 Min.   :0.000000        Min.   : 0.00   Min.   : 5.026           
 1st Qu.:0.001673        1st Qu.: 4.00   1st Qu.: 7.364           
 Median :0.008315        Median :17.00   Median : 8.340           
 Mean   :0.037083        Mean   :23.09   Mean   : 9.751           
 3rd Qu.:0.033621        3rd Qu.:40.00   3rd Qu.:10.840           
 Max.   :0.781887        Max.   :57.00   Max.   :25.343           
  Valley_Depth    
 Min.   :  4.941  
 1st Qu.:121.764  
 Median :195.087  
 Mean   :237.062  
 3rd Qu.:304.421  
 Max.   :770.234  </code></pre>
</div>
</div>
</section>
<section id="mejor-semilla-particion-de-datos-y-mejor-modelo" class="level1">
<h1>16.Mejor Semilla particion de datos y mejor modelo</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>resultados_Lim_Sup_SVM <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">seed =</span> <span class="fu">integer</span>(),</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">C =</span> <span class="fu">numeric</span>(),</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">sigma =</span> <span class="fu">numeric</span>(),</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE_train =</span> <span class="fu">numeric</span>(),</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_train =</span> <span class="fu">numeric</span>(),</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">RMSE_test =</span> <span class="fu">numeric</span>(),</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">R2_test =</span> <span class="fu">numeric</span>()</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>best_rmse  <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>best_model <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>best_seed  <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">500</span>) {</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">set.seed</span>(s)</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>  index <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> data_sf_df<span class="sc">$</span>Lim_sup,</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">p =</span> <span class="fl">0.70</span>,</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">list =</span> <span class="cn">FALSE</span></span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>  train <span class="ot">&lt;-</span> data_sf_df[index, ]</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>  test  <span class="ot">&lt;-</span> data_sf_df[<span class="sc">-</span>index, ]</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>  train_control <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"cv"</span>,</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">number =</span> <span class="dv">10</span>,</span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">allowParallel =</span> <span class="cn">TRUE</span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>  GRID_SVM <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">sigma =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>),</span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">C =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>  best_rmse_seed   <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>  best_model_seed  <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>  best_C_seed      <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>  best_sigma_seed  <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(GRID_SVM)) {</span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>    modelo <span class="ot">&lt;-</span> <span class="fu">train</span>(</span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a>      Lim_sup <span class="sc">~</span> .,</span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> train,</span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>      <span class="at">method =</span> <span class="st">"svmRadial"</span>,</span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">trControl =</span> train_control,</span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">tuneGrid =</span> GRID_SVM[i, , <span class="at">drop =</span> <span class="cn">FALSE</span>],</span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>, <span class="st">"scale"</span>)</span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a>    pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo, test)</span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a>    RMSE_test <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(pred, test<span class="sc">$</span>Lim_sup)</span>
<span id="cb48-60"><a href="#cb48-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-61"><a href="#cb48-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (RMSE_test <span class="sc">&lt;</span> best_rmse_seed) {</span>
<span id="cb48-62"><a href="#cb48-62" aria-hidden="true" tabindex="-1"></a>      best_rmse_seed  <span class="ot">&lt;-</span> RMSE_test</span>
<span id="cb48-63"><a href="#cb48-63" aria-hidden="true" tabindex="-1"></a>      best_model_seed <span class="ot">&lt;-</span> modelo</span>
<span id="cb48-64"><a href="#cb48-64" aria-hidden="true" tabindex="-1"></a>      best_C_seed     <span class="ot">&lt;-</span> GRID_SVM<span class="sc">$</span>C[i]</span>
<span id="cb48-65"><a href="#cb48-65" aria-hidden="true" tabindex="-1"></a>      best_sigma_seed <span class="ot">&lt;-</span> GRID_SVM<span class="sc">$</span>sigma[i]</span>
<span id="cb48-66"><a href="#cb48-66" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb48-67"><a href="#cb48-67" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-68"><a href="#cb48-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-69"><a href="#cb48-69" aria-hidden="true" tabindex="-1"></a>  train_metrics <span class="ot">&lt;-</span> best_model_seed<span class="sc">$</span>results[</span>
<span id="cb48-70"><a href="#cb48-70" aria-hidden="true" tabindex="-1"></a>    best_model_seed<span class="sc">$</span>results<span class="sc">$</span>C <span class="sc">==</span> best_C_seed <span class="sc">&amp;</span></span>
<span id="cb48-71"><a href="#cb48-71" aria-hidden="true" tabindex="-1"></a>    best_model_seed<span class="sc">$</span>results<span class="sc">$</span>sigma <span class="sc">==</span> best_sigma_seed, ]</span>
<span id="cb48-72"><a href="#cb48-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-73"><a href="#cb48-73" aria-hidden="true" tabindex="-1"></a>  RMSE_train <span class="ot">&lt;-</span> train_metrics<span class="sc">$</span>RMSE</span>
<span id="cb48-74"><a href="#cb48-74" aria-hidden="true" tabindex="-1"></a>  R2_train   <span class="ot">&lt;-</span> train_metrics<span class="sc">$</span>Rsquared</span>
<span id="cb48-75"><a href="#cb48-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-76"><a href="#cb48-76" aria-hidden="true" tabindex="-1"></a>  pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(best_model_seed, test)</span>
<span id="cb48-77"><a href="#cb48-77" aria-hidden="true" tabindex="-1"></a>  RMSE_test <span class="ot">&lt;-</span> <span class="fu">RMSE</span>(pred, test<span class="sc">$</span>Lim_sup)</span>
<span id="cb48-78"><a href="#cb48-78" aria-hidden="true" tabindex="-1"></a>  R2_test   <span class="ot">&lt;-</span> <span class="fu">cor</span>(pred, test<span class="sc">$</span>Lim_sup)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb48-79"><a href="#cb48-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-80"><a href="#cb48-80" aria-hidden="true" tabindex="-1"></a>  resultados_Lim_Sup_SVM <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb48-81"><a href="#cb48-81" aria-hidden="true" tabindex="-1"></a>    resultados_Lim_Sup_SVM,</span>
<span id="cb48-82"><a href="#cb48-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data.frame</span>(</span>
<span id="cb48-83"><a href="#cb48-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">seed =</span> s,</span>
<span id="cb48-84"><a href="#cb48-84" aria-hidden="true" tabindex="-1"></a>      <span class="at">C =</span> best_C_seed,</span>
<span id="cb48-85"><a href="#cb48-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">sigma =</span> best_sigma_seed,</span>
<span id="cb48-86"><a href="#cb48-86" aria-hidden="true" tabindex="-1"></a>      <span class="at">RMSE_train =</span> RMSE_train,</span>
<span id="cb48-87"><a href="#cb48-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">R2_train =</span> R2_train,</span>
<span id="cb48-88"><a href="#cb48-88" aria-hidden="true" tabindex="-1"></a>      <span class="at">RMSE_test =</span> RMSE_test,</span>
<span id="cb48-89"><a href="#cb48-89" aria-hidden="true" tabindex="-1"></a>      <span class="at">R2_test =</span> R2_test</span>
<span id="cb48-90"><a href="#cb48-90" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb48-91"><a href="#cb48-91" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb48-92"><a href="#cb48-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-93"><a href="#cb48-93" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (RMSE_test <span class="sc">&lt;</span> best_rmse) {</span>
<span id="cb48-94"><a href="#cb48-94" aria-hidden="true" tabindex="-1"></a>    best_rmse  <span class="ot">&lt;-</span> RMSE_test</span>
<span id="cb48-95"><a href="#cb48-95" aria-hidden="true" tabindex="-1"></a>    best_model <span class="ot">&lt;-</span> best_model_seed</span>
<span id="cb48-96"><a href="#cb48-96" aria-hidden="true" tabindex="-1"></a>    best_seed  <span class="ot">&lt;-</span> s</span>
<span id="cb48-97"><a href="#cb48-97" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb48-98"><a href="#cb48-98" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb48-99"><a href="#cb48-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-100"><a href="#cb48-100" aria-hidden="true" tabindex="-1"></a>best_seed</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 270</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>best_rmse</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.841723</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>best_model</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Support Vector Machines with Radial Basis Function Kernel 

160 samples
 10 predictor

Pre-processing: centered (10), scaled (10) 
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 144, 144, 144, 144, 144, 144, ... 
Resampling results:

  RMSE      Rsquared   MAE     
  14.06706  0.1166654  8.377603

Tuning parameter 'sigma' was held constant at a value of 0.01
Tuning
 parameter 'C' was held constant at a value of 5</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(resultados_Lim_Sup_SVM)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    seed  C sigma RMSE_train   R2_train RMSE_test     R2_test
1      1  5  0.05  11.360890 0.13711696 14.740084 0.080744240
2      2  1  0.05  13.525777 0.16467648  6.866382 0.280746607
3      3  1  0.10  13.112192 0.14484556  7.745329 0.202917637
4      4  1  0.05  11.220798 0.14388751 14.466378 0.126608676
5      5  1  0.10  11.558178 0.19259748 14.211564 0.174343396
6      6  5  0.10  11.782109 0.05393863 16.534980 0.025256560
7      7 10  0.01  12.475007 0.15914260  9.026657 0.235548703
8      8  1  0.10  10.997159 0.24622196 13.757229 0.169437932
9      9  1  0.10  11.179459 0.13888154 15.002787 0.166607922
10    10 10  0.01  11.625325 0.23593393 10.508769 0.088279326
11    11  5  0.01  13.055719 0.15170929 10.025801 0.094031198
12    12  1  0.10  11.554058 0.12282839 13.770456 0.255174680
13    13 10  0.01  12.812022 0.15135569  8.922098 0.149631894
14    14  1  0.10  11.508627 0.14386931 14.664448 0.159234364
15    15  1  0.05  11.965517 0.09516412 13.929382 0.203731126
16    16 10  0.01  12.348155 0.20410686 11.273259 0.152383643
17    17  5  0.05  12.655517 0.16259912 11.169444 0.188631322
18    18 10  0.01  11.069045 0.23952436 15.084798 0.028567032
19    19 10  0.01  11.897423 0.19866681 10.917449 0.091359336
20    20  1  0.05  12.418116 0.16217149 10.687438 0.162476475
21    21  1  0.10   9.502111 0.16247459 18.955081 0.124573624
22    22  1  0.05  13.355110 0.17007952  8.470714 0.175688861
23    23  1  0.10  12.709350 0.19435695 10.172204 0.126905341
24    24  5  0.05  12.183330 0.14033962 10.845197 0.199668668
25    25  1  0.05  11.752857 0.20022214 12.012096 0.152041598
26    26  5  0.01  13.605608 0.15281075  7.297039 0.102712406
27    27  1  0.10  11.889119 0.19140098 14.100450 0.080413359
28    28  1  0.10  10.955706 0.14144109 15.461938 0.112837112
29    29  1  0.05  10.430220 0.27171395 15.647197 0.009328070
30    30  1  0.05  11.070783 0.19661988 14.783362 0.115227023
31    31  1  0.10  10.815119 0.17140110 15.579253 0.122133985
32    32  5  0.05  12.104481 0.20608072 12.282599 0.092225425
33    33  1  0.10  10.015429 0.23059867 16.269643 0.123328610
34    34  5  0.01  13.454355 0.13216718  8.432871 0.150024208
35    35  1  0.10  10.939679 0.17097337 14.995142 0.167511329
36    36  5  0.05  11.728398 0.19846457 12.710310 0.120160012
37    37  5  0.05   9.588583 0.14729100 18.647170 0.075213682
38    38  1  0.10  12.815643 0.14898910  9.180437 0.209454319
39    39  1  0.05  11.137449 0.26892644 14.181906 0.004704016
40    40  1  0.10  12.818718 0.15538920  8.964222 0.143816184
41    41  1  0.05  11.448476 0.29475518 13.589528 0.009096788
42    42  1  0.10  12.003411 0.14710902 11.310957 0.098916343
43    43 10  0.01  11.865689 0.19499267 12.175594 0.124814361
44    44 10  0.01  12.779764 0.18952213 10.224768 0.161329486
45    45  5  0.01  11.903470 0.18044431 11.085713 0.105713168
46    46  5  0.05  11.273177 0.09989651 14.516298 0.254547150
47    47  1  0.10  12.044156 0.16685794 13.427570 0.163980168
48    48  1  0.10  11.695760 0.16427737 14.214833 0.208905570
49    49  5  0.05  13.423241 0.09995095  8.200208 0.267984029
50    50  1  0.05  10.427617 0.18833613 16.175180 0.068875207
51    51  1  0.05  10.756520 0.18936764 15.772900 0.040818780
52    52  5  0.05  13.480550 0.11709061  9.472128 0.232914501
53    53  1  0.05  13.637121 0.11464905  8.127914 0.258692750
54    54  1  0.05  11.186723 0.13381423 13.742851 0.268494835
55    55 10  0.01  12.400124 0.20916907  8.586221 0.083010378
56    56  1  0.10  13.023995 0.15215662  9.001216 0.162567811
57    57  1  0.05  11.809762 0.13048756 14.158588 0.192073687
58    58  1  0.10  10.699135 0.16023159 15.144992 0.201607873
59    59  1  0.10  10.601184 0.20512333 15.403809 0.091189368
60    60  5  0.01  13.062953 0.11737942  9.611819 0.116217352
61    61  5  0.05   9.545005 0.14558937 18.591469 0.110855296
62    62 10  0.01  11.359311 0.19256724 14.623637 0.021576082
63    63 10  0.05  11.903135 0.10550723 15.840479 0.116692357
64    64  1  0.05  13.789972 0.09300799  9.285754 0.201218738
65    65  5  0.05  11.219761 0.17796572 15.016298 0.057159457
66    66  5  0.01  12.836482 0.11776748  9.141044 0.119549066
67    67  1  0.10  12.293351 0.25219503 10.961283 0.058126531
68    68 10  0.01  12.943444 0.14561425 10.577853 0.212143058
69    69  1  0.05  11.359056 0.21198622 14.873896 0.063712606
70    70  1  0.05  11.365245 0.23610620 14.065500 0.043233758
71    71  1  0.05  10.884306 0.24507126 14.765761 0.043702165
72    72  1  0.05  10.351046 0.19679135 15.961950 0.046763932
73    73  1  0.10  11.018628 0.14662899 15.260050 0.167337917
74    74  1  0.10  11.429182 0.18303936 14.132082 0.141947447
75    75 10  0.01  12.597624 0.11033997 11.377842 0.255666323
76    76  5  0.01  13.365226 0.06613964  9.640572 0.180192480
77    77 10  0.01  13.153464 0.11838820  8.385741 0.280334517
78    78  5  0.01  11.429379 0.13931976 14.506500 0.118427721
79    79  1  0.10  13.187780 0.18518164  7.196912 0.178761048
80    80  1  0.10  12.913562 0.16292928  9.217914 0.126623267
81    81 10  0.01  13.112329 0.17229783 10.547830 0.189747610
82    82  5  0.05   8.876157 0.16635692 19.684352 0.093971896
83    83  1  0.10  10.573844 0.11724382 15.965452 0.178019163
84    84  5  0.05  11.793704 0.14803786 14.514600 0.068697299
85    85  1  0.10  13.287189 0.11395435  8.747977 0.243047898
86    86  5  0.05  12.067674 0.21710215 11.074009 0.132114917
87    87  5  0.01  13.278950 0.13321690  8.531508 0.248431627
88    88  1  0.05  10.732241 0.26770436 15.434789 0.022868562
89    89  5  0.01  12.589567 0.20109362 10.008720 0.137217712
90    90  5  0.05  11.725459 0.19649529 13.649832 0.093908712
91    91  5  0.01  13.440409 0.17157827  8.314278 0.164948660
92    92  1  0.10  13.665556 0.18264020  7.520061 0.169953924
93    93 10  0.01  13.346924 0.15477692  7.851957 0.200811953
94    94  1  0.10  10.766016 0.20407295 14.209347 0.194240395
95    95  1  0.10  10.619478 0.20238817 15.931790 0.100781532
96    96  1  0.10  12.428405 0.22403143  9.888382 0.116960927
97    97  5  0.05  11.478597 0.13645076 14.498572 0.205851777
98    98  5  0.05  13.566621 0.11216535  9.213636 0.288175055
99    99  5  0.05  11.959366 0.12964179 14.611556 0.161840293
100  100  5  0.01  13.522247 0.07422199  8.609774 0.237095537
101  101  1  0.05  12.116661 0.18559740 10.813730 0.092218399
102  102  1  0.10  11.557053 0.21626032 14.090522 0.109144866
103  103  1  0.05  10.724566 0.13104913 15.635456 0.216698296
104  104  1  0.05  12.918604 0.16845554  9.101985 0.250673437
105  105 10  0.01  11.013569 0.20315985 15.348053 0.029887889
106  106  5  0.05  11.511682 0.13347696 15.233310 0.054327663
107  107 10  0.01  10.801667 0.17473607 15.010374 0.116196607
108  108  1  0.10   9.776890 0.19193307 18.503070 0.077301949
109  109  1  0.10  12.592799 0.15930191 10.642965 0.083181458
110  110 10  0.05  14.099865 0.09614342 10.092478 0.213977128
111  111  5  0.05  12.248741 0.18372508 11.628911 0.092957894
112  112  1  0.05  13.087751 0.17198093  7.733445 0.190389821
113  113  1  0.10   9.349938 0.21044628 18.714598 0.074298302
114  114  1  0.10  12.745172 0.17128965  9.805431 0.083514022
115  115  1  0.05  11.683082 0.12642225 13.802494 0.236688507
116  116  5  0.05  10.411163 0.11637462 16.543248 0.148590500
117  117  1  0.05  10.655353 0.24692702 15.281878 0.099391000
118  118  1  0.10  11.725364 0.14796304 13.412688 0.221178917
119  119  1  0.05  12.087689 0.25093159 11.214415 0.051084327
120  120  1  0.05  13.143831 0.12327455  9.355323 0.253398829
121  121  5  0.05  10.992532 0.15644012 15.543524 0.064041597
122  122  1  0.10  11.196031 0.19460460 14.118872 0.154306215
123  123 10  0.01  13.163838 0.12074014  9.399521 0.165793672
124  124  1  0.05  11.538466 0.19044169 14.444103 0.010047611
125  125 10  0.01  12.452377 0.13918411 10.733057 0.120320220
126  126 10  0.01  12.334562 0.16655207  9.907153 0.135453236
127  127 10  0.05  11.709813 0.15710254 14.270387 0.080661917
128  128  5  0.05  10.855913 0.20538684 15.107321 0.063809686
129  129  1  0.01  13.778838 0.13085832  7.741815 0.101692702
130  130  1  0.10   9.570058 0.16938114 18.304738 0.078036440
131  131  1  0.05  11.297713 0.10210762 14.609797 0.278360876
132  132  5  0.05  10.445069 0.09444113 16.906395 0.149772927
133  133  1  0.10  11.099331 0.23323201 14.379020 0.143200576
134  134  1  0.10  11.442104 0.19298613 14.573146 0.019744539
135  135  1  0.05  13.128470 0.17813719  9.252575 0.117360810
136  136 10  0.01  11.531205 0.21688442 12.067957 0.098870881
137  137 10  0.01  13.397704 0.11503515  8.872984 0.222783071
138  138  1  0.10  11.499011 0.19665890 13.368475 0.088596316
139  139  1  0.01  12.961847 0.17564501 10.025810 0.044076914
140  140 10  0.01  11.131491 0.17534169 15.149780 0.067259024
141  141  1  0.05  11.737111 0.13988705 13.663477 0.226945606
142  142  1  0.10  10.237696 0.21315095 15.605393 0.172211325
143  143 10  0.01  12.383191 0.19128544 10.558227 0.112275382
144  144  1  0.05   8.720080 0.27440678 19.633012 0.084858116
145  145  1  0.05  12.963312 0.13323753  9.593594 0.179414906
146  146 10  0.01  11.689170 0.23390957 13.584004 0.018781094
147  147 10  0.01  10.291091 0.15392528 16.208321 0.282792246
148  148  1  0.05  11.483259 0.19013189 14.033991 0.019779571
149  149  1  0.10  10.408041 0.17207015 15.144965 0.262271225
150  150  1  0.10  10.948074 0.18090495 15.113799 0.074417455
151  151  1  0.10  11.741342 0.13242648 13.843971 0.142448346
152  152  1  0.10  11.974752 0.14606247 14.074506 0.149930353
153  153  5  0.01  12.686099 0.12121304  9.939451 0.161092115
154  154  5  0.05  11.813431 0.13662555 14.119582 0.179622556
155  155  1  0.05  12.014821 0.22025495 13.294821 0.049355273
156  156  1  0.01  12.424024 0.15272889 10.733618 0.119755538
157  157  1  0.10  11.656220 0.10136381 14.520847 0.186712756
158  158  1  0.10  11.112698 0.17072889 14.735542 0.155265885
159  159  1  0.05  10.273925 0.18243427 17.838456 0.138831383
160  160  1  0.05  10.226645 0.24278720 15.902553 0.104226451
161  161  1  0.05  10.639217 0.18501360 15.760860 0.071193243
162  162  1  0.10  13.061228 0.17246307  7.699451 0.142562431
163  163  1  0.01  13.090853 0.19422355  9.108510 0.037248366
164  164  5  0.01  12.878431 0.19326090  9.686760 0.117471478
165  165  5  0.01  11.860063 0.20055877 10.715776 0.060952985
166  166  1  0.10  11.799788 0.16898685  9.945290 0.113609873
167  167  1  0.10  13.794575 0.14224007  7.486336 0.194628709
168  168 10  0.01  10.133514 0.16815966 16.182411 0.215591693
169  169  5  0.05  10.972088 0.16543983 15.201418 0.171823734
170  170  1  0.10  12.337995 0.23170666  9.578955 0.225838718
171  171  1  0.05  12.134492 0.14637004  9.735114 0.183713794
172  172  1  0.10   9.625372 0.18858276 17.994762 0.102692899
173  173 10  0.01  12.385530 0.18723310 10.064991 0.103368604
174  174 10  0.01  13.065447 0.14117581  7.860598 0.172671707
175  175  1  0.10   9.695167 0.17138621 18.935586 0.188817591
176  176  1  0.05  11.163859 0.18138363 14.429967 0.062545051
177  177  1  0.10  11.720909 0.13280475 14.583298 0.110698141
178  178  1  0.10  13.416428 0.09653349  7.145750 0.320455523
179  179  1  0.05   9.924742 0.20672348 17.646106 0.102497703
180  180 10  0.01  12.751593 0.16002996 10.491150 0.116082814
181  181  1  0.05  11.502387 0.14995083 14.663263 0.086721088
182  182  1  0.10  11.696171 0.21280497 10.710001 0.092003513
183  183  1  0.10  12.194082 0.24010732  9.299410 0.098719921
184  184  5  0.05   9.467617 0.17709525 18.855688 0.103017634
185  185  1  0.10  11.950079 0.12343106 14.021436 0.240889021
186  186  1  0.05  13.658147 0.12888831  7.848694 0.110950057
187  187  1  0.10  11.496572 0.17693487 14.014056 0.141628077
188  188  1  0.05  12.878263 0.17949862  9.465931 0.215758522
189  189  1  0.05  11.187783 0.17932166 15.611292 0.153129675
190  190  1  0.05  11.132605 0.22049385 14.558485 0.073144978
191  191  5  0.05  12.310877 0.09490053 12.161284 0.227077944
192  192  1  0.05  10.414650 0.23759232 15.451838 0.167192884
193  193  1  0.10  12.520124 0.10849501 10.038528 0.236626788
194  194  1  0.05  11.765034 0.16234634 14.180534 0.067899721
195  195  1  0.05  11.968945 0.24541492 11.684952 0.087988692
196  196 10  0.01  12.538849 0.12634044 10.410049 0.123968524
197  197  1  0.05  12.301418 0.20019822 11.361550 0.072287954
198  198  1  0.10  12.456774 0.22099610  9.835973 0.165991771
199  199  1  0.05  12.626452 0.10581617 10.901675 0.129236425
200  200  5  0.05  13.009909 0.08480069 10.578476 0.188603881
201  201  1  0.10  12.349419 0.16430415 13.579281 0.045526116
202  202  1  0.10  11.565985 0.16424107 13.758998 0.167927307
203  203  5  0.01  13.060135 0.14530994  9.418759 0.181751170
204  204 10  0.01  10.730053 0.13679476 15.820671 0.200201746
205  205  1  0.10  10.982756 0.21155586 14.942840 0.032623855
206  206  1  0.10  13.650134 0.10049089  7.245424 0.217916712
207  207  1  0.10   9.132788 0.20163075 18.907412 0.075938694
208  208  5  0.05  11.848347 0.16692166 14.030947 0.156547767
209  209  1  0.01  13.626071 0.16724315  8.752322 0.087909191
210  210  1  0.10  12.742981 0.11292675 10.519100 0.108432770
211  211  5  0.05  10.865476 0.14986478 16.086642 0.126895846
212  212  1  0.05  10.794781 0.19075189 15.523613 0.114401006
213  213  1  0.10  12.138436 0.07892458 13.484939 0.158602331
214  214  1  0.01  12.693513 0.19685456 10.895862 0.103430929
215  215  1  0.05  12.496975 0.18517517 10.635770 0.080522374
216  216  1  0.10  10.949708 0.21987539 14.699451 0.191247893
217  217  1  0.05  13.273828 0.19940550  7.987693 0.112869956
218  218  1  0.10  13.203013 0.13755282  8.563210 0.217654557
219  219  5  0.01  13.185962 0.20076844  9.324465 0.082027101
220  220  5  0.01  12.673513 0.21926192 10.057320 0.091104040
221  221  1  0.10  12.784495 0.21335479  9.125575 0.101503238
222  222 10  0.05  13.660535 0.07080739  8.834466 0.349617061
223  223  1  0.01  13.457820 0.08852120  9.990095 0.148128711
224  224  1  0.05  13.021801 0.14697520 10.115635 0.122296139
225  225 10  0.01  12.912979 0.19810734  9.376684 0.238241274
226  226  1  0.05  11.756893 0.24310026 12.647453 0.118653243
227  227  1  0.01  11.975602 0.17967222 12.273991 0.016004963
228  228  1  0.10  12.282390 0.18969240 10.655136 0.135158548
229  229 10  0.05  11.898611 0.07944509 15.182693 0.186271534
230  230  5  0.05  13.335149 0.05599873  9.484806 0.267711909
231  231  1  0.10  10.628332 0.16814667 15.911827 0.168141665
232  232  1  0.01  13.013234 0.17583706  9.688623 0.040351143
233  233  5  0.01  12.525478 0.13563445 10.119938 0.223656998
234  234  5  0.05  11.102792 0.08252103 15.781201 0.213220514
235  235  1  0.05  10.521789 0.24833249 14.453284 0.135743649
236  236  1  0.05  12.878414 0.20934549  8.615314 0.111057343
237  237  5  0.01  12.654702 0.15487145  9.679779 0.187844107
238  238  1  0.05  12.978716 0.19173659  9.573964 0.216526244
239  239  1  0.10   9.107024 0.18419125 19.502660 0.134325478
240  240  5  0.01  10.836970 0.17075294 15.335838 0.057220280
241  241 10  0.01  11.159443 0.13393958 15.405071 0.088282093
242  242 10  0.01  11.471593 0.12109175 14.870864 0.143223055
243  243  1  0.05   9.853811 0.22963125 16.731418 0.085157961
244  244  1  0.05  13.025294 0.14275309 10.192145 0.104692866
245  245  1  0.10  11.370984 0.14757472 14.510386 0.174200846
246  246  1  0.05  10.576091 0.24890033 15.614641 0.016727984
247  247  1  0.10  13.060527 0.18049116  8.476454 0.135387576
248  248  1  0.10  12.449221 0.20302035 10.047998 0.085754179
249  249  1  0.05  12.461891 0.18072812 10.872244 0.138092577
250  250  1  0.05  12.308070 0.13243794 10.820547 0.226379906
251  251  5  0.05  10.846416 0.16338766 15.239158 0.182790631
252  252 10  0.01  10.783910 0.19757573 15.369647 0.068448985
253  253  1  0.05  10.601797 0.21994485 15.467796 0.044301918
254  254  1  0.10  12.335444 0.14873680 12.013674 0.086121844
255  255 10  0.01  13.203134 0.10434504  9.271501 0.131663477
256  256  1  0.10  12.615572 0.19038110  9.022222 0.164855334
257  257  1  0.05  12.394953 0.17417797  9.417105 0.150102236
258  258  1  0.10   9.323444 0.29229770 18.276137 0.110526532
259  259 10  0.01  12.217409 0.14293382 12.203870 0.144361278
260  260  1  0.10  11.837981 0.13302958 14.498221 0.054380499
261  261  5  0.05  12.905582 0.13080688  9.420635 0.222858371
262  262  5  0.05  12.834479 0.12265672  9.749965 0.159699050
263  263  1  0.10   8.906209 0.24542482 19.084605 0.069915457
264  264  1  0.05  12.591883 0.13583046 10.188356 0.167422732
265  265  1  0.10   9.045308 0.24767445 19.341511 0.022815509
266  266  1  0.10   9.674607 0.13673312 18.915409 0.085520011
267  267  1  0.05  12.880465 0.17663061  8.150580 0.184122386
268  268  1  0.10  11.096116 0.19720099 14.451153 0.049348836
269  269  5  0.05   9.554030 0.12419135 19.087023 0.190157313
270  270  5  0.01  14.067060 0.11666540  6.841723 0.190399061
271  271  5  0.05   9.954167 0.13804632 18.432282 0.116816291
272  272  1  0.01  12.817490 0.21887722  8.939676 0.018005384
273  273  1  0.05  11.459664 0.19689797 14.047931 0.184424284
274  274  1  0.10  13.297048 0.13808457  8.231975 0.264524382
275  275  1  0.10  12.661669 0.20662187 10.602612 0.061878460
276  276 10  0.01  10.842826 0.16785985 15.888187 0.040963221
277  277  1  0.05  12.488539 0.15653952  8.951680 0.140828303
278  278  1  0.05  12.917156 0.15675149  8.691995 0.165491320
279  279  1  0.10  11.233427 0.19826084 14.251945 0.171435792
280  280  1  0.05  13.437197 0.14124688  8.010995 0.239720350
281  281  5  0.01  13.310930 0.12172597  8.837796 0.187736864
282  282 10  0.01  12.069801 0.17764795 10.841958 0.196189884
283  283  1  0.05  11.835478 0.14849757 13.785920 0.077388584
284  284  5  0.01  13.554037 0.19255140  8.058039 0.234495086
285  285  1  0.05  11.737032 0.16635321 13.442495 0.094905997
286  286  1  0.05  11.459839 0.15068172 14.819337 0.070593743
287  287  1  0.10  12.658575 0.20388966 10.879199 0.068228419
288  288  1  0.10  12.115811 0.10810473 11.370169 0.191216830
289  289  1  0.05  11.716990 0.21417039 11.220805 0.106699040
290  290  5  0.01  12.523294 0.21057847  8.908059 0.149949117
291  291  1  0.10  10.717326 0.29743113 14.338173 0.117048823
292  292  1  0.05  12.921838 0.19745026  9.424026 0.170595603
293  293  1  0.10  12.896023 0.14819005  9.552524 0.089655919
294  294  1  0.05  13.007743 0.18049864  8.637682 0.145795483
295  295  1  0.10   9.747675 0.34236131 16.397080 0.086252043
296  296  1  0.01  10.954699 0.15382786 15.473247 0.006577998
297  297  1  0.10  12.838363 0.20811926  9.370911 0.105986518
298  298  5  0.05  10.871597 0.14665157 15.348974 0.116249981
299  299  1  0.05  11.263571 0.15962487 14.471323 0.195553567
300  300  5  0.05  11.075872 0.08901844 15.773273 0.170361174
301  301  1  0.05  11.322550 0.21167284 10.260163 0.231520620
302  302  1  0.10  12.820100 0.19144738  9.527214 0.074957681
303  303 10  0.01  12.044469 0.16438456  9.975650 0.149438886
304  304 10  0.01  11.334703 0.14485433 14.703826 0.069982073
305  305  1  0.10  11.453408 0.11705487 14.188348 0.201203278
306  306  1  0.10  11.773213 0.25051100 13.891227 0.018128828
307  307  1  0.10  11.754349 0.16420977 13.673646 0.060493201
308  308  1  0.10  11.750844 0.12538390 13.956496 0.117785090
309  309 10  0.05  10.119476 0.23643340 16.108021 0.065870942
310  310  1  0.05  13.204139 0.21538133  8.577543 0.138864844
311  311  1  0.05  10.828589 0.18004000 16.168807 0.073923171
312  312  1  0.10  11.584278 0.18685282 13.642118 0.129554775
313  313  1  0.10  12.541506 0.18520941  8.784407 0.145158837
314  314  1  0.10  10.724835 0.24615190 15.618880 0.024928127
315  315  1  0.05  13.500707 0.14272122  7.792384 0.192180793
316  316 10  0.01  11.488803 0.16813103 15.169958 0.013932358
317  317  1  0.05  12.618293 0.22881568  8.273555 0.145746403
318  318  1  0.01  12.825775 0.18571512 10.631904 0.120369247
319  319  1  0.10  11.128210 0.17721561 15.452410 0.157557947
320  320  1  0.05  12.468698 0.26961742  8.733761 0.109637737
321  321  1  0.05  12.883592 0.19415015  7.217742 0.182503170
322  322 10  0.01  12.151604 0.17701967 11.480895 0.193686802
323  323  1  0.10  12.988033 0.13632106 10.091114 0.171041230
324  324  1  0.05  10.763666 0.18784235 15.471254 0.133146081
325  325  1  0.10  11.733584 0.25775006 11.782690 0.039319976
326  326  1  0.01  13.129398 0.10577400  9.846417 0.153337481
327  327 10  0.01  12.070853 0.19467737 12.621614 0.098354927
328  328 10  0.05   9.411068 0.25296390 16.903691 0.189348167
329  329  1  0.10  12.763021 0.20905081  9.901336 0.076927435
330  330  5  0.05  11.512623 0.16903162 14.582141 0.062102825
331  331  1  0.10  11.542441 0.09260883 14.570111 0.156263226
332  332 10  0.01  12.955625 0.16906211  8.359904 0.241013833
333  333  5  0.01  13.548047 0.10089435  8.853888 0.134401156
334  334 10  0.01  12.355210 0.13748357 10.740349 0.194347253
335  335 10  0.01  11.887544 0.08329102 13.933721 0.053019136
336  336 10  0.01  11.730014 0.22869006 11.847171 0.122392557
337  337 10  0.01  10.252997 0.19899234 16.569563 0.042797922
338  338  1  0.10  11.590919 0.11397890 14.937641 0.118202638
339  339  1  0.10  11.984253 0.12517472 13.346555 0.186353856
340  340  1  0.05  11.637134 0.21741757 10.541035 0.222163304
341  341  1  0.05  12.491232 0.16341262  8.983921 0.168936535
342  342  1  0.10   9.305524 0.23178141 18.926233 0.080734740
343  343  1  0.01  13.813975 0.19061893  7.458807 0.134777652
344  344  5  0.05  10.929758 0.16698922 14.825477 0.119128629
345  345  1  0.10  10.690290 0.10293667 15.898741 0.176397208
346  346  1  0.05  13.059762 0.22492316  8.166423 0.099416140
347  347  1  0.05  10.841091 0.21918678 15.671733 0.171860297
348  348  1  0.10  12.577985 0.21462841  7.461159 0.181638876
349  349  5  0.01  12.954146 0.14210880  9.777842 0.137398049
350  350  1  0.10  10.413834 0.16607680 17.785871 0.094110730
351  351  1  0.05  12.460716 0.19776138 11.308064 0.098631962
352  352  1  0.05  12.765568 0.13432605  8.762271 0.143834119
353  353  1  0.10  11.765418 0.25010863 13.184704 0.026556833
354  354  1  0.10  10.982870 0.17461246 14.968318 0.135808997
355  355  5  0.01  13.609998 0.13424140  8.285699 0.165789366
356  356 10  0.05  13.840964 0.06721117  9.508558 0.219938147
357  357  1  0.10  10.625748 0.26030874 14.621706 0.131976631
358  358 10  0.01  13.108775 0.08196473 10.223124 0.224999545
359  359  1  0.10  13.399272 0.17597704  7.860905 0.104874066
360  360 10  0.01  11.989158 0.19462829 12.049330 0.146207103
361  361  1  0.01  13.365597 0.12246162  8.740260 0.139588231
362  362  1  0.01  12.155074 0.26650326 10.702945 0.031290457
363  363  1  0.05  12.482133 0.15814905 10.134070 0.176569850
364  364  1  0.10  10.764115 0.24354054 14.677088 0.132929341
365  365  1  0.05  12.270488 0.23526286 10.864383 0.086367653
366  366  1  0.01  13.289972 0.20160971  9.166557 0.028496539
367  367  5  0.01  13.034801 0.19010963 10.207206 0.122037292
368  368  5  0.05  11.814075 0.09478403 14.241821 0.112271615
369  369  1  0.10  12.134257 0.16333953 10.167952 0.076500947
370  370  5  0.05  11.315343 0.12548849 15.898515 0.062765801
371  371  1  0.10  12.181365 0.22619780 11.094764 0.095773027
372  372  1  0.10  11.001676 0.22149384 14.908178 0.078483578
373  373 10  0.05  11.811772 0.14679335 14.831753 0.158647285
374  374  1  0.10  10.897740 0.22225827 14.280697 0.172327403
375  375  1  0.10  12.285621 0.20119528 10.058140 0.119904863
376  376  1  0.05  10.694835 0.19477257 16.070905 0.036737341
377  377  1  0.10  11.583546 0.17134967 14.024516 0.236856185
378  378  1  0.01  11.466107 0.18653056 15.258491 0.015675797
379  379  5  0.05  12.131371 0.14517381 11.293350 0.198333152
380  380  1  0.10  13.622675 0.11642739  8.041010 0.206684614
381  381  1  0.05  11.252125 0.19518583 13.851497 0.077438285
382  382  1  0.05  10.826896 0.17301013 14.519258 0.114139982
383  383  5  0.05  12.210456 0.12645078 11.081222 0.212721824
384  384  1  0.10  12.342434 0.18580128 10.205771 0.111751921
385  385 10  0.01  12.608061 0.18044861 10.042719 0.185963861
386  386  1  0.10  12.865846 0.12063049  8.702324 0.221895920
387  387  1  0.10  12.614000 0.13094223  9.934487 0.132808850
388  388  1  0.10  10.972135 0.16000445 14.894060 0.069308559
389  389 10  0.01  12.888787 0.14955787  9.343487 0.222373832
390  390  1  0.10  11.196487 0.15697597 14.986566 0.058718299
391  391  1  0.05  10.548398 0.18720657 16.154595 0.111148573
392  392  1  0.10  11.014109 0.17612457 14.508147 0.155797008
393  393  5  0.05  12.865425 0.23215772  9.174550 0.177879274
394  394  1  0.01  11.979404 0.17360336 14.359072 0.009010381
395  395 10  0.01  13.271243 0.13121234  8.877709 0.132594956
396  396 10  0.01  12.079920 0.12133288  9.003146 0.286551521
397  397  1  0.05  11.523491 0.22904613 13.981058 0.142482776
398  398  1  0.10  10.645355 0.17833651 15.466042 0.115151710
399  399  5  0.05  10.586831 0.15765730 15.955523 0.079129525
400  400  1  0.05  11.449833 0.15638042 14.272133 0.099158215
401  401  1  0.10  10.863642 0.23320529 14.670026 0.008245994
402  402 10  0.05  11.934024 0.12988365 14.328962 0.198419888
403  403  1  0.05  11.735214 0.24328011 13.495093 0.045412049
404  404  5  0.05  10.667224 0.11505739 17.415479 0.162316570
405  405  5  0.05  11.938983 0.17025348 11.949867 0.140929399
406  406  1  0.10  11.139733 0.17008055 14.721611 0.178313648
407  407  1  0.01  13.899966 0.16001309  7.791941 0.091478937
408  408 10  0.05  13.692118 0.10029495  8.275352 0.359027153
409  409 10  0.01  11.972333 0.20060442 12.501081 0.053922498
410  410  1  0.10  12.874468 0.10236799  9.478739 0.186996652
411  411  1  0.10  11.843140 0.19001271 13.441525 0.131712479
412  412  5  0.05  11.515616 0.12200243 14.358512 0.232056400
413  413  1  0.01  12.992849 0.15066673  9.646160 0.085127852
414  414  1  0.05  11.653077 0.17428042 13.820008 0.188542553
415  415 10  0.01  12.559822 0.15644144 10.067605 0.269568242
416  416  1  0.05  11.544829 0.12539605 14.402643 0.154117366
417  417 10  0.01   9.711851 0.27500246 16.265463 0.101925308
418  418  1  0.10  10.563607 0.21875013 15.714832 0.069488769
419  419  1  0.05  10.192986 0.22650890 15.989490 0.137629400
420  420 10  0.01  11.324411 0.17505827 14.706203 0.152143996
421  421  5  0.05  10.155328 0.16629949 16.319552 0.168910174
422  422  1  0.05  11.849558 0.13398840 14.222044 0.041055590
423  423  5  0.05  12.406877 0.15059440 10.206108 0.170000834
424  424  1  0.10  11.986027 0.07335359 13.814373 0.149904194
425  425  5  0.05  10.059801 0.17094090 18.268059 0.091078120
426  426  5  0.05  11.302250 0.12828026 15.905908 0.062474761
427  427  5  0.05  11.124188 0.12562016 15.498247 0.157171752
428  428  1  0.05  11.384798 0.21018338 14.114998 0.148986391
429  429 10  0.05  13.180559 0.11092433  9.506248 0.184021606
430  430  5  0.05  10.434834 0.16358079 17.793934 0.113658267
431  431  1  0.05  11.090036 0.18125788 15.310175 0.103620427
432  432  1  0.10  12.124410 0.20042766 11.302402 0.123002687
433  433  1  0.05  12.543784 0.14004030 11.308664 0.097469617
434  434 10  0.01  13.326252 0.11512020  9.275097 0.354591250
435  435  1  0.10  11.543945 0.22947499 11.024220 0.066840895
436  436  1  0.10  13.234476 0.13548518  7.350820 0.326440696
437  437  1  0.05  10.913288 0.25806958 14.681672 0.119697543
438  438  1  0.05  10.144949 0.28901012 15.516397 0.024640455
439  439  5  0.05   9.994167 0.20923654 18.162382 0.088822499
440  440  1  0.10  10.257721 0.16733301 17.668068 0.096928996
441  441  1  0.10  11.747190 0.15454275 13.364851 0.073371550
442  442  1  0.10  10.048081 0.22064865 16.565727 0.115211747
443  443  1  0.10  12.364701 0.11866817 11.844627 0.066105910
444  444  1  0.10  11.106578 0.22670030 14.725708 0.028020235
445  445  5  0.05  10.911523 0.18872675 15.658466 0.149875132
446  446  5  0.01  12.675290 0.20460284 10.006075 0.080767067
447  447  5  0.01  13.188650 0.16335719  8.294008 0.166081071
448  448  1  0.10  12.319140 0.14780451 11.622699 0.176015785
449  449  1  0.05  12.625374 0.14476921 10.452965 0.228576954
450  450 10  0.05  13.063344 0.15271814 10.693169 0.107724210
451  451  1  0.01  12.706254 0.18889682 10.182068 0.044169298
452  452  1  0.10  12.003791 0.16355532  9.724901 0.108117363
453  453  1  0.05  11.907623 0.13052651  9.728639 0.074392618
454  454  1  0.01  13.505477 0.12338682  9.091167 0.106217709
455  455  5  0.05  13.242882 0.16193087  9.090707 0.120611727
456  456  5  0.05  11.494245 0.23124200 14.545150 0.013390312
457  457 10  0.05  13.728674 0.11252628 10.854115 0.189989114
458  458  1  0.05  11.513945 0.19084869 14.085237 0.038215064
459  459  1  0.10  12.864067 0.13442029  8.505290 0.295008752
460  460  5  0.05  13.088307 0.13973413  9.840579 0.124955771
461  461  1  0.10  11.653774 0.14359320 14.550989 0.200750876
462  462  1  0.10  13.292239 0.17343716  8.097921 0.178233392
463  463  1  0.05   9.641976 0.15975770 18.438101 0.130717334
464  464  5  0.01  11.405155 0.19968292 11.685379 0.129832945
465  465  1  0.10  13.761038 0.15954542  7.766210 0.136644682
466  466 10  0.01  11.851169 0.16184863 10.744335 0.126916601
467  467  1  0.10  11.437057 0.16464191 14.839329 0.170401250
468  468 10  0.05  13.844232 0.07406081  9.319663 0.280295510
469  469  1  0.10  11.782434 0.16975048 13.850432 0.043996611
470  470 10  0.05  12.443245 0.09019651 11.388504 0.181792197
471  471  5  0.01  12.567327 0.23114019  9.493021 0.118168898
472  472  1  0.05  11.504463 0.22850132 14.161333 0.110963327
473  473  1  0.10  12.758372 0.18168915 10.264091 0.081727703
474  474  1  0.10  13.012863 0.20340139  8.379960 0.221152847
475  475 10  0.01  11.287579 0.12915479 15.412075 0.085727319
476  476 10  0.01  12.103971 0.14748329  9.543350 0.179739149
477  477  1  0.05  10.911685 0.21304229 15.202732 0.027320206
478  478  1  0.05  11.742516 0.18542057 14.111939 0.173976412
479  479  1  0.05  10.993897 0.20164267 15.366053 0.032780101
480  480  5  0.05  11.067078 0.17805262 15.419470 0.067452035
481  481  1  0.10  11.715261 0.14635682 13.589249 0.188590282
482  482  5  0.05   9.662628 0.12838101 19.359168 0.072372570
483  483  1  0.01  13.357410 0.07563877 10.323339 0.264991874
484  484  1  0.10  10.848066 0.20602668 14.742158 0.097151664
485  485  1  0.05   9.984586 0.15076910 17.784571 0.126154806
486  486  1  0.05  12.869619 0.16949981  9.261527 0.201954062
487  487  1  0.10  13.476075 0.13787716  9.421762 0.163644921
488  488  1  0.10  10.687503 0.12706484 15.530625 0.179427024
489  489  1  0.10  11.397515 0.15638323 14.664726 0.151070341
490  490 10  0.01  11.075580 0.15802320 15.483307 0.148001426
491  491  1  0.10  12.160045 0.24754557 11.043795 0.034678164
492  492  1  0.10  13.529727 0.13702239  7.309204 0.225846253
493  493 10  0.05  12.106047 0.12145501 11.833410 0.176310399
494  494 10  0.05  11.816569 0.08513452 14.450045 0.100855957
495  495  5  0.01  12.608831 0.19901600 10.245407 0.065557782
496  496  1  0.05  10.954909 0.15250230 15.701966 0.069053315
497  497  5  0.05  12.328342 0.16605494  9.370316 0.172845826
498  498  1  0.10  12.276628 0.17777939 11.455944 0.047795043
499  499  1  0.10   9.723625 0.19889123 18.127853 0.134325352
500  500  1  0.10  11.435427 0.18263399 14.704681 0.070293236</code></pre>
</div>
</div>
</section>
<section id="importancia-de-variables" class="level1">
<h1>17.Importancia de variables</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>var_imp_svm_obj <span class="ot">&lt;-</span> <span class="fu">varImp</span>(best_model, <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(var_imp_svm_obj)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>loess r-squared variable importance

                          Overall
Topographic_Wetness_Index  100.00
MCARI                       64.88
Valley_Depth                63.54
Suelos_                     39.65
NDTI                        34.70
CI                          33.94
LS_Factor                   30.05
HV                          14.27
C.O                         12.06
Relative_Slope_Position      0.00</code></pre>
</div>
</div>
</section>
<section id="importancia-de-variables-1" class="level1">
<h1>18.Importancia de variables</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> var_imp_svm_obj<span class="sc">$</span>importance</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>imp<span class="sc">$</span>variables <span class="ot">&lt;-</span> <span class="fu">rownames</span>(imp)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(imp) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>var_imp_svm <span class="ot">&lt;-</span> imp[, <span class="fu">c</span>(<span class="st">"variables"</span>, <span class="st">"Overall"</span>)]</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(var_imp_svm) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"variables"</span>, <span class="st">"importance"</span>)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>var_imp_svm<span class="sc">$</span>importance <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(var_imp_svm<span class="sc">$</span>importance)</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>var_imp_svm <span class="ot">&lt;-</span> var_imp_svm[<span class="fu">order</span>(<span class="sc">-</span>var_imp_svm<span class="sc">$</span>importance), ]</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(var_imp_svm)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   variables importance
9  Topographic_Wetness_Index  100.00000
5                      MCARI   64.88086
10              Valley_Depth   63.54316
8                    Suelos_   39.64583
6                       NDTI   34.69810
2                         CI   33.93608
4                  LS_Factor   30.04581
3                         HV   14.27336
1                        C.O   12.05534
7    Relative_Slope_Position    0.00000</code></pre>
</div>
</div>
</section>
<section id="se-grafican-para-entender-cúal-está-influyendo-más-en-el-modelo" class="level1">
<h1>19.Se grafican para entender cúal está influyendo más en el modelo</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>SVM_Sup <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(var_imp_svm <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(importance),</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">reorder</span>(variables, importance), <span class="at">y =</span> importance)) <span class="sc">+</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Variables"</span>,</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Importancia"</span>,</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Importancia de variables – SVM (Lim_sup)"</span></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.text  =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">14</span>),</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">18</span>)</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(SVM_Sup)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SVM_Lim_Sup_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="guardar-grafica-importancia_variables" class="level1">
<h1>20. Guardar grafica Importancia_variables</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">filename =</span> <span class="st">"Importancia_variables_SVM.png"</span>,</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">plot =</span> SVM_Sup,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">path =</span> <span class="st">"D:/MAESTRIA/Trabajo_final/graficos resultados"</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">18</span>,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">14</span>,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">"cm"</span>,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">dpi =</span> <span class="dv">300</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="predicción-y-visualización" class="level1">
<h1>Predicción y visualización</h1>
</section>
<section id="nombres-de-capas-variables-del-modelo" class="level1">
<h1>21. Nombres de capas = variables del modelo</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>dataVARS <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"CI"</span>,<span class="st">"C.O"</span>, <span class="st">"MCARI"</span>, <span class="st">"LS_Factor"</span>, <span class="st">"NDTI"</span>, <span class="st">"HV"</span>,</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a> <span class="st">"Relative_Slope_Position"</span>, <span class="st">"Suelos_"</span>, <span class="st">"Topographic_Wetness_Index"</span> ,<span class="st">"Valley_Depth"</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="co"># En terra usamos 'subset' para quedarnos solo con las capas que necesitamos</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Asumiendo que tu objeto raster se llama 'raster' (o cámbiale el nombre)</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a>r_predictores <span class="ot">&lt;-</span> <span class="fu">subset</span>(raster, dataVARS)</span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificación de seguridad (Debe salir T</span></span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"¿Están todas las variables?"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "¿Están todas las variables?"</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">all</span>(dataVARS <span class="sc">%in%</span> <span class="fu">names</span>(r_predictores)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
</section>
<section id="aplicar-modelo" class="level1">
<h1>22. Aplicar modelo</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>Limite_Sup_SVM <span class="ot">&lt;-</span> terra<span class="sc">::</span><span class="fu">predict</span>(</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  r_predictores,</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">model =</span> best_model,   <span class="co"># ← OBLIGATORIO</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">fun =</span> <span class="cf">function</span>(model, d, ...) {</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">predict</span>(model, d)</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  },</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">na.rm =</span> <span class="cn">TRUE</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
|---------|---------|---------|---------|
=========================================
                                          </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  Limite_Sup_SVM,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Predicción del Límite Superior (SVM)"</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SVM_Lim_Sup_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="guardar-modelo-rf_grid" class="level1">
<h1>23.Guardar modelo rf_grid</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(Limite_Sup_SVM, <span class="st">"D:/Mapa final/Limite_Superior_SVM.tif"</span>, <span class="at">overwrite =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
|---------|---------|---------|---------|
=========================================
                                          </code></pre>
</div>
</div>
</section>
<section id="guardar-imagen-png-modelo-rf_grid" class="level1">
<h1>24.Guardar imagen png modelo rf_grid</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"D:/MAESTRIA/Trabajo_final/graficos resultados/Limite_Superior_SVM.png"</span>,</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">3000</span>,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">2500</span>,</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">res =</span> <span class="dv">300</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>  Limite_Sup_SVM,</span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Predicción del Límite Superior del departamento de Meta y Vichada (SVM)"</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
</div>
</section>
<section id="recorte-de-un-area-especifica" class="level1">
<h1>25. Recorte de un area especifica</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(terra)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Raster de predicción</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> Limite_Sup_SVM   <span class="co"># o rast("Limite_Superior_RF.tif")</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Polígono de la zona de interés</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>zona <span class="ot">&lt;-</span> <span class="fu">vect</span>(<span class="st">"D:/MAESTRIA/Trabajo_final/shp tesis/Altillanura_2.shp"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="reproyectar" class="level1">
<h1>26.Reproyectar</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>zona <span class="ot">&lt;-</span> <span class="fu">project</span>(zona, <span class="fu">crs</span>(r))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="cortar-area-de-estudio" class="level1">
<h1>27.Cortar area de estudio</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>r_crop <span class="ot">&lt;-</span> <span class="fu">crop</span>(r, zona)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>r_crop <span class="ot">&lt;-</span> <span class="fu">mask</span>(r_crop, zona)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="mapa" class="level1">
<h1>28.Mapa</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(r_crop, <span class="at">main =</span> <span class="st">"Predicion Limite Superior (SVM)</span><span class="sc">\n</span><span class="st"> Altillanura Plana del Departamento del Meta"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="SVM_Lim_Sup_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="guardar-mapa" class="level1">
<h1>29.Guardar mapa</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">writeRaster</span>(</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  r_crop,</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"D:/Mapa final/Lim_sup_SVM_Altillanura.tif"</span>,</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">overwrite =</span> <span class="cn">TRUE</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="guardar-mapa-como-imagen" class="level1">
<h1>30.Guardar mapa como imagen</h1>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">png</span>(</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"D:/MAESTRIA/Trabajo_final/graficos resultados/Limite_Superior_Altillanura_SVM.png"</span>,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">width =</span> <span class="dv">3000</span>,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">height =</span> <span class="dv">2500</span>,</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">res =</span> <span class="dv">300</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>  r_crop,</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">"Predicion Limite Superior (SVM)</span><span class="sc">\n</span><span class="st"> Altillanura Plana del Departamento del Meta"</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>
